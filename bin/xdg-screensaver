#!/bin/sh

if [ ! "$1" ]; then
    exit
fi

case "$1" in
    lock)
        i3lock || true  # LXQt throws an error if the return value is non-zero
        ;;
    reset)
        # VLC calls this every 30 seconds.
        # Most xdg-screensaver implementations will disable themselves here.
        # I'll just tell LXQt it should wait a little longer before locking the screen,
        #   since VLC never reactivates the screensaver.
        dbus-send --dest=org.freedesktop.ScreenSaver --type=method_call /ScreenSaver org.freedesktop.ScreenSaver.SimulateUserActivity
        # Of course, this won't work if the locking timeout is shorter than 30 seconds.
        ;;
    *)
        echo "$(date +%Y%m%d%H%M%S) $@"
        echo "$(date +%Y%m%d%H%M%S) $@" >> /tmp/xdg-screensaver-failed
        ;;
esac
